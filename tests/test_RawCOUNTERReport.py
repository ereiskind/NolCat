"""Test methods in RawCOUNTERReport."""
import os
from pathlib import Path
import pytest
import pandas as pd
from nolcat.raw_COUNTER_report import RawCOUNTERReport


@pytest.fixture
def sample_R4_dataframe():
    """Reads the sample CSVs of reformatted R4 data into a single dataframe using the same expression as in the `determine_if_resources_match` function."""
    R4_reports = []
    for file in os.listdir(Path('.', 'tests', 'data')):  # The paths are based off the project root so pytest can be invoked through the Python interpreter at the project root
        R4_reports.append(Path('.', 'tests', 'data', file))
    
    R4_dataframe = pd.concat(
        [
            pd.read_csv(
                CSV,
                dtype={
                    # 'Interface' is fine as default float64
                    'Resource_Name': 'string',
                    'Publisher': 'string',
                    'Platform': 'string',
                    'DOI': 'string',
                    'Proprietary_ID': 'string',
                    'ISBN': 'string',
                    'Print_ISSN': 'string',
                    'Online_ISSN': 'string',
                    'Data_Type': 'string',
                    'Metric_Type': 'string',
                    # R4_Month uses parse_dates
                    # R4_Count is fine as default int64
                },
                parse_dates=['R4_Month'],  # For this to work, the dates need to be ISO-formatted strings (with CSVs, all the values are strings)
                encoding='unicode_escape',  # This allows for CSVs with non-ASCII characters
                infer_datetime_format=True  # Speeds up the parsing process if the format can be inferred; since all dates will be in the same format, this should be easy to do
            ) for CSV in R4_reports
        ],
        ignore_index=True
    )
    yield R4_dataframe


def test_perform_deduplication_matching(sample_R4_dataframe):
    """Uses the `sample_R4_dataframe` as a single dataframe argument to test that the `perform_deduplication_matching` function returns the data representing resource matches both confirmed and needing confirmation."""
    R4_test_data = RawCOUNTERReport(sample_R4_dataframe)
    assert R4_test_data.perform_deduplication_matching() == (
        {
            (139, 133), (137, 133), (135, 133), (144, 136), (76, 75), (111, 110), (97, 94), (95, 94), (132, 129), (130, 129), (42, 40), (98, 85), (96, 85), (116, 113), (57, 55), (141, 132), (92, 90), (139, 132), (142, 140), (127, 125), (136, 128), (134, 128), (132, 128), (102, 101), (96, 89), (143, 131), (94, 89), (141, 131), (92, 89), (123, 120), (121, 120), (108, 105), (137, 136), (144, 139), (142, 139), (83, 81), (24, 23), (138, 127), (136, 127), (134, 127), (12, 11), (89, 85), (98, 88), (96, 88), (143, 130), (94, 88), (123, 119), (139, 135), (137, 135), (144, 138), (78, 77), (24, 22), (140, 126), (138, 126), (136, 126), (97, 96), (132, 131), (93, 84), (91, 84), (89, 84), (98, 87), (94, 92), (141, 134), (139, 134), (142, 125), (115, 111), (140, 125), (113, 111), (23, 22), (54, 53), (38, 37), (136, 130), (134, 130), (132, 130), (96, 91), (143, 133), (94, 91), (141, 133), (92, 91), (123, 122), (108, 107), (115, 110), (113, 110), (144, 141), (142, 141), (54, 52), (129, 126), (138, 129), (127, 126), (136, 129), (134, 129), (104, 102), (14, 13), (91, 87), (89, 87), (98, 90), (96, 90), (143, 132), (94, 90), (123, 121), (33, 32), (108, 106), (139, 137), (144, 140), (83, 82), (133, 125), (131, 125), (140, 128), (129, 125), (138, 128), (104, 101), (134, 133), (93, 86), (91, 86), (122, 117), (89, 86), (98, 89), (120, 117), (118, 117), (61, 59), (143, 136), (141, 136), (139, 136), (80, 78), (144, 127), (142, 127), (115, 113), (140, 127), (136, 132), (134, 132), (95, 85), (93, 85), (91, 85), (96, 93), (143, 135), (94, 93), (141, 135), (80, 77), (144, 126), (142, 126), (115, 112), (113, 112), (144, 143), (131, 128), (129, 128), (138, 131), (136, 131), (134, 131), (97, 84), (95, 84), (16, 15), (91, 89), (98, 92), (96, 92), (143, 134), (66, 65), (144, 125), (144, 142), (87, 84), (85, 84), (133, 127), (131, 127), (140, 130), (129, 127), (138, 130), (104, 103), (47, 45), (93, 88), (91, 88), (122, 119), (89, 88), (98, 91), (120, 119), (143, 138), (141, 138), (139, 138), (86, 84), (144, 129), (135, 126), (133, 126), (131, 126), (140, 129), (142, 129), (136, 134), (46, 45), (95, 87), (93, 87), (124, 118), (122, 118), (120, 118), (61, 60), (96, 95), (143, 137), (141, 137), (80, 79), (137, 125), (135, 125), (144, 128), (142, 128), (115, 114), (131, 130), (138, 133), (136, 133), (97, 86), (95, 86), (124, 117), (98, 94), (96, 94), (112, 110), (56, 55), (87, 86), (133, 129), (142, 132), (131, 129), (140, 132), (138, 132), (97, 85), (106, 105), (93, 90), (91, 90), (122, 121), (98, 93), (126, 125), (143, 140), (141, 140), (87, 85), (28, 27), (135, 128), (133, 128), (142, 131), (144, 131), (140, 131), (103, 101), (107, 105), (47, 46), (95, 89), (93, 89), (124, 120), (122, 120), (143, 139), (141, 139), (82, 81), (139, 127), (90, 85), (137, 127), (88, 85), (135, 127), (144, 130), (86, 85), (142, 130), (138, 135), (136, 135), (97, 88), (79, 77), (95, 88), (124, 119), (98, 96), (92, 84), (141, 126), (139, 126), (90, 84), (137, 126), (88, 84), (133, 131), (142, 134), (140, 134), (138, 134), (97, 87), (93, 92), (98, 95), (143, 125), (141, 125), (114, 111), (139, 125), (143, 142), (112, 111), (135, 130), (144, 133), (133, 130), (142, 133), (140, 133), (97, 91), (95, 91), (93, 91), (124, 122), (130, 126), (128, 126), (11, 9), (116, 110), (114, 110), (143, 141), (53, 52), (90, 87), (139, 129), (137, 129), (88, 87), (135, 129), (144, 132), (103, 102), (140, 137), (107, 106), (138, 137), (97, 90), (95, 90), (124, 121), (132, 125), (130, 125), (128, 125), (10, 9), (141, 128), (92, 86), (139, 128), (90, 86), (137, 128), (88, 86), (119, 117), (121, 117), (60, 59), (142, 136), (140, 136), (138, 136), (97, 89), (79, 78), (98, 97), (143, 127), (94, 85), (141, 127), (92, 85), (114, 113), (137, 132), (135, 132), (144, 135), (133, 132), (142, 135), (140, 135), (97, 93), (95, 93), (130, 128), (98, 84), (96, 84), (143, 126), (94, 84), (114, 112), (116, 112), (139, 131), (90, 89), (137, 131), (135, 131), (144, 134), (140, 139), (97, 92), (95, 92), (124, 123), (132, 127), (130, 127), (128, 127), (11, 10), (116, 111), (141, 130), (92, 88), (139, 130), (90, 88), (137, 130), (121, 119), (31, 30), (142, 138), (140, 138), (50, 49), (134, 126), (132, 126), (100, 99), (12, 10), (96, 87), (143, 129), (94, 87), (141, 129), (92, 87), (116, 115), (121, 118), (123, 118), (119, 118), (137, 134), (135, 134), (144, 137), (142, 137), (138, 125), (136, 125), (134, 125), (97, 95), (12, 9), (98, 86), (96, 86), (94, 86), (143, 128), (116, 114), (123, 117), (57, 56)
        },
        {
            ('Early European Books->Collection 10', 'Early European Books->Collection 1'): [(81, 77), (81, 78), (81, 79), (81, 80), (82, 77), (82, 78), (82, 79), (82, 80), (83, 77), (83, 78), (83, 79), (83, 80)],
            ('Periodicals Archive Online->Periodicals Archive Online Foundation Collection 2', 'Periodicals Archive Online->Periodicals Archive Online Foundation Collection'): [(105, 101), (105, 102), (105, 103), (105, 104), (106, 101), (106, 102), (106, 103), (106, 104), (107, 101), (107, 102), (107, 103), (107, 104), (108, 101), (108, 102), (108, 103), (108, 104)],
            ('Periodicals Archive Online->Periodicals Archive Online Foundation Collection 3', 'Periodicals Archive Online->Periodicals Archive Online Foundation Collection'): [(109, 101), (109, 102), (109, 103), (109, 104)], ('Periodicals Archive Online->Periodicals Archive Online Foundation Collection 3', 'Periodicals Archive Online->Periodicals Archive Online Foundation Collection 2'): [(109, 105), (109, 106), (109, 107), (109, 108)],
            (('Artificial Intelligence Research and Development: Proceedings of the 15th International Conference of the Catalan Association for Artificial Intelligence (Frontiers in Artificial Intelligence and Appl', None, '978-1-61499-139-7', None, None, 'Book'), ('Artificial Intelligence Research and Development: Proceedings of the 13th International Conference of the Catalan Association for Artificial Intelligence (Frontiers in artificial intelligence and appl', None, '978-1-60750-643-0', None, None, 'Book')): [(3, 2)],
            (('Artificial Intelligence Research and Development: Proceedings of the 19th International Conference of the Catalan Association for Artificial Intelligence, Barcelona, Catalonia, Spain, October 19-21, 2', None, '978-1-61499-696-5', None, None, 'Book'), ('Artificial Intelligence Research and Development: Proceedings of the 13th International Conference of the Catalan Association for Artificial Intelligence (Frontiers in artificial intelligence and appl', None, '978-1-60750-643-0', None, None, 'Book')): [(4, 2)],
            (('Artificial Intelligence Research and Development: Proceedings of the 19th International Conference of the Catalan Association for Artificial Intelligence, Barcelona, Catalonia, Spain, October 19-21, 2', None, '978-1-61499-696-5', None, None, 'Book'), ('Artificial Intelligence Research and Development: Proceedings of the 15th International Conference of the Catalan Association for Artificial Intelligence (Frontiers in Artificial Intelligence and Appl', None, '978-1-61499-139-7', None, None, 'Book')): [(4, 3)],
            (('Beauty', None, None, None, None, 'Book'), ('Beauty', None, None, None, None, 'Book')): [(6, 5), (7, 5), (7, 6), (8, 5), (8, 6), (8, 7)],
            (('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States: A Guide for Providers of Victim and Support Services', None, '978-0-309-30492-4', None, None, 'Book'), ('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States', None, '978-0-309-28658-9', None, None, 'Book')): [(13, 9), (13, 10), (13, 11), (13, 12), (14, 9), (14, 10), (14, 11), (14, 12)],
            (('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States: A Guide for the Health Care Sector', None, '978-0-309-31046-8', None, None, 'Book'), ('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States', None, '978-0-309-28658-9', None, None, 'Book')): [(15, 9), (15, 10), (15, 11), (15, 12), (16, 9), (16, 10), (16, 11), (16, 12)],
            (('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States: A Guide for the Health Care Sector', None, '978-0-309-31046-8', None, None, 'Book'), ('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States: A Guide for Providers of Victim and Support Services', None, '978-0-309-30492-4', None, None, 'Book')): [(15, 13), (15, 14), (16, 13), (16, 14)],
            (('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States: A Guide for the Legal Sector', None, '978-0-309-31343-8', None, None, 'Book'), ('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States', None, '978-0-309-28658-9', None, None, 'Book')): [(17, 9), (17, 10), (17, 11), (17, 12)],
            (('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States: A Guide for the Legal Sector', None, '978-0-309-31343-8', None, None, 'Book'), ('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States: A Guide for Providers of Victim and Support Services', None, '978-0-309-30492-4', None, None, 'Book')): [(17, 13), (17, 14)],
            (('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States: A Guide for the Legal Sector', None, '978-0-309-31343-8', None, None, 'Book'), ('Confronting Commercial Sexual Exploitation and Sex Trafficking of Minors in the United States: A Guide for the Health Care Sector', None, '978-0-309-31046-8', None, None, 'Book')): [(17, 15), (17, 16)],
            (('Early European Books->Collection 10', None, None, None, None, 'Database'), ('Early European Books->Collection 1', None, None, None, None, 'Database')): [(81, 77), (81, 78), (81, 79), (81, 80), (82, 77), (82, 78), (82, 79), (82, 80), (83, 77), (83, 78), (83, 79), (83, 80)],
            (('Historical Linguistics 1999: Selected Papers from the 14th International Conference on Historical Linguistics, Vancouver, 9-13 August 1999 (Amsterdam studies in the theory and history of linguistic sc', None, None, None, None, 'Book'), ('Artificial Intelligence Research and Development: Proceedings of the 13th International Conference of the Catalan Association for Artificial Intelligence (Frontiers in artificial intelligence and appl', None, '978-1-60750-643-0', None, None, 'Book')): [(20, 2)],
            (('Historical Linguistics 1999: Selected Papers from the 14th International Conference on Historical Linguistics, Vancouver, 9-13 August 1999 (Amsterdam studies in the theory and history of linguistic sc', None, None, None, None, 'Book'), ('Artificial Intelligence Research and Development: Proceedings of the 15th International Conference of the Catalan Association for Artificial Intelligence (Frontiers in Artificial Intelligence and Appl', None, '978-1-61499-139-7', None, None, 'Book')): [(20, 3)],
            (('Historical Linguistics 1999: Selected Papers from the 14th International Conference on Historical Linguistics, Vancouver, 9-13 August 1999 (Amsterdam studies in the theory and history of linguistic sc', None, None, None, None, 'Book'), ('Historical Linguistics 1993: Selected Papers From the 11th International Conference on Historical Linguistics, Los Angeles, 16-20 August 1993 (Amsterdam Studies in the Theory and History of Linguistic', None, None, None, None, 'Book')): [(20, 19)],
            (('Historical Linguistics, 1987: Papers From the 8th International Conference on Historical Linguistics (8. ICHL): Lille, 31 August-4 September 1987 (Amsterdam Studies in the Theory and History of Lingui', None, None, None, None, 'Book'), ('Historical Linguistics 1993: Selected Papers From the 11th International Conference on Historical Linguistics, Los Angeles, 16-20 August 1993 (Amsterdam Studies in the Theory and History of Linguistic', None, None, None, None, 'Book')): [(21, 19)],
            (('Historical Linguistics, 1987: Papers From the 8th International Conference on Historical Linguistics (8. ICHL): Lille, 31 August-4 September 1987 (Amsterdam Studies in the Theory and History of Lingui', None, None, None, None, 'Book'), ('Historical Linguistics 1999: Selected Papers from the 14th International Conference on Historical Linguistics, Vancouver, 9-13 August 1999 (Amsterdam studies in the theory and history of linguistic sc', None, None, None, None, 'Book')): [(21, 20)],
            (('Learning Bodies', None, '978-87-7684-266-6', None, None, 'Book'), ('Learning & Behavior', None, None, None, '1543-4494', 'Book')): [(27, 26), (28, 26)],
            (('Learning Bootstrap', None, '978-1-78216-185-1', None, None, 'Book'), ('Learning & Behavior', None, None, None, '1543-4494', 'Book')): [(29, 26)],
            (('Learning Bootstrap', None, '978-1-78216-185-1', None, None, 'Book'), ('Learning Bodies', None, '978-87-7684-266-6', None, None, 'Book')): [(29, 27), (29, 28)],
            (('Learning Python', None, '978-1-56592-893-0', None, None, 'Book'), ('Learning & Behavior', None, None, None, '1543-4494', 'Book')): [(30, 26), (31, 26)],
            (('Learning Python', None, '978-1-56592-893-0', None, None, 'Book'), ('Learning Bodies', None, '978-87-7684-266-6', None, None, 'Book')): [(30, 27), (30, 28), (31, 27), (31, 28)],
            (('Learning Python', None, '978-1-56592-893-0', None, None, 'Book'), ('Learning Bootstrap', None, '978-1-78216-185-1', None, None, 'Book')): [(30, 29), (31, 29)],
            (('Learning Theories: A to Z', None, '978-1-280-92804-8', None, None, 'Book'), ('Learning & Behavior', None, None, None, '1543-4494', 'Book')): [(32, 26), (33, 26)],
            (('Learning Theories: A to Z', None, '978-1-280-92804-8', None, None, 'Book'), ('Learning Bodies', None, '978-87-7684-266-6', None, None, 'Book')): [(32, 27), (32, 28), (33, 27), (33, 28)],
            (('Learning Theories: A to Z', None, '978-1-280-92804-8', None, None, 'Book'), ('Learning Bootstrap', None, '978-1-78216-185-1', None, None, 'Book')): [(32, 29), (33, 29)],
            (('Learning Theories: A to Z', None, '978-1-280-92804-8', None, None, 'Book'), ('Learning Python', None, '978-1-56592-893-0', None, None, 'Book')): [(32, 30), (32, 31), (33, 30), (33, 31)],
            (('New Stoicism', None, '978-1-4008-1096-3', None, None, 'Book'), ('New Scientist', None, None, None, '0262-4079', 'Book')): [(37, 36), (38, 36)],
            (('Periodicals Archive Online->Periodicals Archive Online Foundation Collection 2', None, None, None, None, 'Database'), ('Periodicals Archive Online->Periodicals Archive Online Foundation Collection', None, None, None, None, 'Database')): [(105, 101), (105, 102), (105, 103), (105, 104), (106, 101), (106, 102), (106, 103), (106, 104), (107, 101), (107, 102), (107, 103), (107, 104), (108, 101), (108, 102), (108, 103), (108, 104)],
            (('Periodicals Archive Online->Periodicals Archive Online Foundation Collection 3', None, None, None, None, 'Database'), ('Periodicals Archive Online->Periodicals Archive Online Foundation Collection', None, None, None, None, 'Database')): [(109, 101), (109, 102), (109, 103), (109, 104)],
            (('Periodicals Archive Online->Periodicals Archive Online Foundation Collection 3', None, None, None, None, 'Database'), ('Periodicals Archive Online->Periodicals Archive Online Foundation Collection 2', None, None, None, None, 'Database')): [(109, 105), (109, 106), (109, 107), (109, 108)],
            (('ProQuest Social Sciences Premium Collection->ERIC', None, None, None, None, 'Database'), ('ERIC', None, None, None, None, 'Database')): [(110, 84), (110, 85), (110, 86), (110, 87), (110, 88), (110, 89), (110, 90), (110, 91), (110, 92), (110, 93), (110, 94), (110, 95), (110, 96), (110, 97), (110, 98), (111, 84), (111, 85), (111, 86), (111, 87), (111, 88), (111, 89), (111, 90), (111, 91), (111, 92), (111, 93), (111, 94), (111, 95), (111, 96), (111, 97), (111, 98), (112, 84), (112, 85), (112, 86), (112, 87), (112, 88), (112, 89), (112, 90), (112, 91), (112, 92), (112, 93), (112, 94), (112, 95), (112, 96), (112, 97), (112, 98), (113, 84), (113, 85), (113, 86), (113, 87), (113, 88), (113, 89), (113, 90), (113, 91), (113, 92), (113, 93), (113, 94), (113, 95), (113, 96), (113, 97), (113, 98), (114, 84), (114, 85), (114, 86), (114, 87), (114, 88), (114, 89), (114, 90), (114, 91), (114, 92), (114, 93), (114, 94), (114, 95), (114, 96), (114, 97), (114, 98), (115, 84), (115, 85), (115, 86), (115, 87), (115, 88), (115, 89), (115, 90), (115, 91), (115, 92), (115, 93), (115, 94), (115, 95), (115, 96), (115, 97), (115, 98), (116, 84), (116, 85), (116, 86), (116, 87), (116, 88), (116, 89), (116, 90), (116, 91), (116, 92), (116, 93), (116, 94), (116, 95), (116, 96), (116, 97), (116, 98)],
            (('Social Science Premium Collection->Education Collection->ERIC', None, None, None, None, 'Database'), ('ERIC', None, None, None, None, 'Database')): [(117, 84), (117, 85), (117, 86), (117, 87), (117, 88), (117, 89), (117, 90), (117, 91), (117, 92), (117, 93), (117, 94), (117, 95), (117, 96), (117, 97), (117, 98), (118, 84), (118, 85), (118, 86), (118, 87), (118, 88), (118, 89), (118, 90), (118, 91), (118, 92), (118, 93), (118, 94), (118, 95), (118, 96), (118, 97), (118, 98), (119, 84), (119, 85), (119, 86), (119, 87), (119, 88), (119, 89), (119, 90), (119, 91), (119, 92), (119, 93), (119, 94), (119, 95), (119, 96), (119, 97), (119, 98), (120, 84), (120, 85), (120, 86), (120, 87), (120, 88), (120, 89), (120, 90), (120, 91), (120, 92), (120, 93), (120, 94), (120, 95), (120, 96), (120, 97), (120, 98), (121, 84), (121, 85), (121, 86), (121, 87), (121, 88), (121, 89), (121, 90), (121, 91), (121, 92), (121, 93), (121, 94), (121, 95), (121, 96), (121, 97), (121, 98), (122, 84), (122, 85), (122, 86), (122, 87), (122, 88), (122, 89), (122, 90), (122, 91), (122, 92), (122, 93), (122, 94), (122, 95), (122, 96), (122, 97), (122, 98), (123, 84), (123, 85), (123, 86), (123, 87), (123, 88), (123, 89), (123, 90), (123, 91), (123, 92), (123, 93), (123, 94), (123, 95), (123, 96), (123, 97), (123, 98), (124, 84), (124, 85), (124, 86), (124, 87), (124, 88), (124, 89), (124, 90), (124, 91), (124, 92), (124, 93), (124, 94), (124, 95), (124, 96), (124, 97), (124, 98)],
            (('Social Science Premium Collection->Education Collection->ERIC', None, None, None, None, 'Database'), ('ProQuest Social Sciences Premium Collection->ERIC', None, None, None, None, 'Database')): [(117, 110), (117, 111), (117, 112), (117, 113), (117, 114), (117, 115), (117, 116), (118, 110), (118, 111), (118, 112), (118, 113), (118, 114), (118, 115), (118, 116), (119, 110), (119, 111), (119, 112), (119, 113), (119, 114), (119, 115), (119, 116), (120, 110), (120, 111), (120, 112), (120, 113), (120, 114), (120, 115), (120, 116), (121, 110), (121, 111), (121, 112), (121, 113), (121, 114), (121, 115), (121, 116), (122, 110), (122, 111), (122, 112), (122, 113), (122, 114), (122, 115), (122, 116), (123, 110), (123, 111), (123, 112), (123, 113), (123, 114), (123, 115), (123, 116), (124, 110), (124, 111), (124, 112), (124, 113), (124, 114), (124, 115), (124, 116)],
            (('Superhero Ethics: 10 Comic Book Heroes; 10 Ways to Save the World; Which One Do We Need Most Now?', None, '978-1-59947-552-3', None, None, 'Book'), ('Superhero Ethics: 10 Comic Book Heroes; 10 Ways to Save the World; Which One Do We Need Most Now?', None, None, None, None, 'Book')): [(42, 41)],
            (('Superhero Ethics: 10 Comic Book Heroes; 10 Ways to Save the World; Which One Do We Need Most Now?', None, '978-1-59947-552-X', None, None, 'Book'), ('Superhero Ethics: 10 Comic Book Heroes; 10 Ways to Save the World; Which One Do We Need Most Now?', None, '978-1-59947-552-3', None, None, 'Book')): [(43, 40), (43, 42)],
            (('Superhero Ethics: 10 Comic Book Heroes; 10 Ways to Save the World; Which One Do We Need Most Now?', None, '978-1-59947-552-X', None, None, 'Book'), ('Superhero Ethics: 10 Comic Book Heroes; 10 Ways to Save the World; Which One Do We Need Most Now?', None, None, None, None, 'Book')): [(43, 41)],
            (('Superhero Ethics: 10 Comic Book Heroes; 10 Ways to Save the World; Which One Do We Need Most Now?', None, None, None, None, 'Book'), ('Superhero Ethics: 10 Comic Book Heroes; 10 Ways to Save the World; Which One Do We Need Most Now?', None, '978-1-59947-552-3', None, None, 'Book')): [(41, 40)],
            (('The History Of Torture', None, '978-1-306-11564-3', None, None, 'Book'), ('A History of Ukraine', None, '978-1-4426-7037-2', None, None, 'Book')): [(49, 1), (50, 1)],
            (('The Scientific Revolution', None, '978-1-281-43040-3', None, None, 'Book'), ('New Scientist', None, None, None, '0262-4079', 'Book')): [(52, 36), (53, 36), (54, 36)],
            (('The yellow wallpaper', None, '978-0-585-15016-1', None, None, 'Book'), ('The Yale Swallow Protocol', None, '978-3-319-05113-0', None, None, 'Book')): [(62, 59), (62, 60), (62, 61)],
            (('Women and Language Debate: A Sourcebook', None, '978-0-585-03362-4', None, None, 'Book'), ('Women and Language', None, None, '8755-4550', None, 'Serial')): [(145, 125), (145, 126), (145, 127), (145, 128), (145, 129), (145, 130), (145, 131), (145, 132), (145, 133), (145, 134), (145, 135), (145, 136), (145, 137), (145, 138), (145, 139), (145, 140), (145, 141), (145, 142), (145, 143), (145, 144)],
            (('World Film Locations : Mumbai', None, '978-1-84150-679-1', None, None, 'Book'), ('World Film Locations : Buenos Aires', None, '978-1-78320-340-6', None, None, 'Book')): [(65, 64), (66, 64)],
            (('World Film Locations:  Melbourne', None, '978-1-84150-678-4', None, None, 'Book'), ('World Film Locations : Buenos Aires', None, '978-1-78320-340-6', None, None, 'Book')): [(67, 64)],
            (('World Film Locations:  Melbourne', None, '978-1-84150-678-4', None, None, 'Book'), ('World Film Locations : Mumbai', None, '978-1-84150-679-1', None, None, 'Book')): [(67, 65), (67, 66)],
            (('World Film Locations: Barcelona', None, '978-1-78320-107-5', None, None, 'Book'), ('World Film Locations : Buenos Aires', None, '978-1-78320-340-6', None, None, 'Book')): [(68, 64)],
            (('World Film Locations: Barcelona', None, '978-1-78320-107-5', None, None, 'Book'), ('World Film Locations : Mumbai', None, '978-1-84150-679-1', None, None, 'Book')): [(68, 65), (68, 66)],
            (('World Film Locations: Barcelona', None, '978-1-78320-107-5', None, None, 'Book'), ('World Film Locations:  Melbourne', None, '978-1-84150-678-4', None, None, 'Book')): [(68, 67)],
            (('World Film Locations: Beijing', None, '978-1-84150-677-7', None, None, 'Book'), ('World Film Locations : Buenos Aires', None, '978-1-78320-340-6', None, None, 'Book')): [(69, 64)],
            (('World Film Locations: Beijing', None, '978-1-84150-677-7', None, None, 'Book'), ('World Film Locations : Mumbai', None, '978-1-84150-679-1', None, None, 'Book')): [(69, 65), (69, 66)],
            (('World Film Locations: Beijing', None, '978-1-84150-677-7', None, None, 'Book'), ('World Film Locations:  Melbourne', None, '978-1-84150-678-4', None, None, 'Book')): [(69, 67)],
            (('World Film Locations: Beijing', None, '978-1-84150-677-7', None, None, 'Book'), ('World Film Locations: Barcelona', None, '978-1-78320-107-5', None, None, 'Book')): [(69, 68)],
            (('World Film Locations: Berlin', None, '978-1-84150-680-7', None, None, 'Book'), ('World Film Locations : Buenos Aires', None, '978-1-78320-340-6', None, None, 'Book')): [(70, 64)],
            (('World Film Locations: Berlin', None, '978-1-84150-680-7', None, None, 'Book'), ('World Film Locations : Mumbai', None, '978-1-84150-679-1', None, None, 'Book')): [(70, 65), (70, 66)],
            (('World Film Locations: Berlin', None, '978-1-84150-680-7', None, None, 'Book'), ('World Film Locations:  Melbourne', None, '978-1-84150-678-4', None, None, 'Book')): [(70, 67)],
            (('World Film Locations: Berlin', None, '978-1-84150-680-7', None, None, 'Book'), ('World Film Locations: Barcelona', None, '978-1-78320-107-5', None, None, 'Book')): [(70, 68)],
            (('World Film Locations: Berlin', None, '978-1-84150-680-7', None, None, 'Book'), ('World Film Locations: Beijing', None, '978-1-84150-677-7', None, None, 'Book')): [(70, 69)],
            (('World Film Locations: Dublin', None, '978-1-84150-592-3', None, None, 'Book'), ('World Film Locations : Buenos Aires', None, '978-1-78320-340-6', None, None, 'Book')): [(71, 64)],
            (('World Film Locations: Dublin', None, '978-1-84150-592-3', None, None, 'Book'), ('World Film Locations : Mumbai', None, '978-1-84150-679-1', None, None, 'Book')): [(71, 65), (71, 66)],
            (('World Film Locations: Dublin', None, '978-1-84150-592-3', None, None, 'Book'), ('World Film Locations:  Melbourne', None, '978-1-84150-678-4', None, None, 'Book')): [(71, 67)],
            (('World Film Locations: Dublin', None, '978-1-84150-592-3', None, None, 'Book'), ('World Film Locations: Barcelona', None, '978-1-78320-107-5', None, None, 'Book')): [(71, 68)],
            (('World Film Locations: Dublin', None, '978-1-84150-592-3', None, None, 'Book'), ('World Film Locations: Beijing', None, '978-1-84150-677-7', None, None, 'Book')): [(71, 69)],
            (('World Film Locations: Dublin', None, '978-1-84150-592-3', None, None, 'Book'), ('World Film Locations: Berlin', None, '978-1-84150-680-7', None, None, 'Book')): [(71, 70)],
            (('World Film Locations: Marseilles', None, '978-1-78320-172-3', None, None, 'Book'), ('World Film Locations : Buenos Aires', None, '978-1-78320-340-6', None, None, 'Book')): [(72, 64)],
            (('World Film Locations: Marseilles', None, '978-1-78320-172-3', None, None, 'Book'), ('World Film Locations : Mumbai', None, '978-1-84150-679-1', None, None, 'Book')): [(72, 65), (72, 66)],
            (('World Film Locations: Marseilles', None, '978-1-78320-172-3', None, None, 'Book'), ('World Film Locations:  Melbourne', None, '978-1-84150-678-4', None, None, 'Book')): [(72, 67)],
            (('World Film Locations: Marseilles', None, '978-1-78320-172-3', None, None, 'Book'), ('World Film Locations: Barcelona', None, '978-1-78320-107-5', None, None, 'Book')): [(72, 68)],
            (('World Film Locations: Marseilles', None, '978-1-78320-172-3', None, None, 'Book'), ('World Film Locations: Beijing', None, '978-1-84150-677-7', None, None, 'Book')): [(72, 69)],
            (('World Film Locations: Marseilles', None, '978-1-78320-172-3', None, None, 'Book'), ('World Film Locations: Berlin', None, '978-1-84150-680-7', None, None, 'Book')): [(72, 70)],
            (('World Film Locations: Marseilles', None, '978-1-78320-172-3', None, None, 'Book'), ('World Film Locations: Dublin', None, '978-1-84150-592-3', None, None, 'Book')): [(72, 71)],
            (('World Film Locations: Vienna', None, '978-1-84150-736-1', None, None, 'Book'), ('World Film Locations : Buenos Aires', None, '978-1-78320-340-6', None, None, 'Book')): [(73, 64)],
            (('World Film Locations: Vienna', None, '978-1-84150-736-1', None, None, 'Book'), ('World Film Locations : Mumbai', None, '978-1-84150-679-1', None, None, 'Book')): [(73, 65), (73, 66)],
            (('World Film Locations: Vienna', None, '978-1-84150-736-1', None, None, 'Book'), ('World Film Locations:  Melbourne', None, '978-1-84150-678-4', None, None, 'Book')): [(73, 67)],
            (('World Film Locations: Vienna', None, '978-1-84150-736-1', None, None, 'Book'), ('World Film Locations: Barcelona', None, '978-1-78320-107-5', None, None, 'Book')): [(73, 68)],
            (('World Film Locations: Vienna', None, '978-1-84150-736-1', None, None, 'Book'), ('World Film Locations: Beijing', None, '978-1-84150-677-7', None, None, 'Book')): [(73, 69)],
            (('World Film Locations: Vienna', None, '978-1-84150-736-1', None, None, 'Book'), ('World Film Locations: Berlin', None, '978-1-84150-680-7', None, None, 'Book')): [(73, 70)],
            (('World Film Locations: Vienna', None, '978-1-84150-736-1', None, None, 'Book'), ('World Film Locations: Dublin', None, '978-1-84150-592-3', None, None, 'Book')): [(73, 71)],
            (('World Film Locations: Vienna', None, '978-1-84150-736-1', None, None, 'Book'), ('World Film Locations: Marseilles', None, '978-1-78320-172-3', None, None, 'Book')): [(73, 72)],
            (('Yale Law Journal', None, None, None, '0044-0094', 'Book'), ('Library Journal', None, None, None, '0363-0277', 'Book')): [(74, 35)],
            (('Yale Law Journal', None, None, None, '0044-0094', 'Book'), ('Whole Dog Journal', None, None, None, '1097-5322', 'Book')): [(74, 63)],
            (('Yellow Wallpaper', None, '978-1-77651-048-1', None, None, 'Book'), ('The yellow wallpaper', None, '978-0-585-15016-1', None, None, 'Book')): [(75, 62), (76, 62)]
        }
    )


def test_harvest_SUSHI_report(sample_R4_dataframe):
    #ToDo: Write a docstring when the format of the return value is set
    pass
    

def test_load_data_into_database(sample_R4_dataframe):
    #ToDo: Write a docstring when the format of the return value is set
    pass