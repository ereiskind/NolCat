[
    {
        "op": "core/column-reorder",
        "columnNames": [
            "Item",
            "Database",
            "Title",
            "Publisher",
            "Publisher_ID",
            "Platform",
            "Authors",
            "Publication_Date",
            "Article_Version",
            "DOI",
            "Proprietary_ID",
            "ISBN",
            "Print_ISSN",
            "Online_ISSN",
            "URI",
            "Data_Type",
            "Section_Type",
            "YOP",
            "Access_Type",
            "Access_Method",
            "Parent_Title",
            "Parent_Authors",
            "Parent_Publication_Date",
            "Parent_Article_Version",
            "Parent_Data_Type",
            "Parent_DOI",
            "Parent_Proprietary_ID",
            "Parent_ISBN",
            "Parent_Print_ISSN",
            "Parent_Online_ISSN",
            "Parent_URI",
            "Metric_Type",
            "Begin_Date",
            "Count"
        ],
        "description": "Reorder fields to match order of attributes in `COUNTERData`"
    },
    // Remove all fields containing only null values
    {
        "op": "core/row-reorder",
        "mode": "row-based",
        "sorting": {
            "criteria": [
                {
                    "valueType": "string",
                    "column": "Database",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Title",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Item",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Publisher",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Publisher_ID",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Platform",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Data_Type",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Section_Type",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "number",
                    "column": "YOP",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false
                },
                {
                    "valueType": "string",
                    "column": "Access_Type",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Access_Method",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                // Item_Contributors
                {
                    "valueType": "string",
                    "column": "Authors",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                // Item_Dates
                {
                    "valueType": "date",
                    "column": "Publication_Date",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false
                },
                // Item_Attributes
                {
                    "valueType": "string",
                    "column": "Article_Version",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                // Item_ID
                {
                    "valueType": "string",
                    "column": "DOI",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Proprietary_ID",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "ISBN",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Print_ISSN",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Online_ISSN",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "URI",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                // Item_Parent
                {
                    "valueType": "string",
                    "column": "Parent_Title",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Parent_Data_Type",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                // Item_Parent > Item_Contributors
                {
                    "valueType": "string",
                    "column": "Parent_Authors",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                // Item_Parent > Item_Dates
                {
                    "valueType": "date",
                    "column": "Parent_Publication_Date",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false
                },
                // Item_Parent > Item_Attributes
                {
                    "valueType": "string",
                    "column": "Parent_Article_Version",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                // Item_Parent > Item_ID
                {
                    "valueType": "string",
                    "column": "Parent_DOI",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Parent_Proprietary_ID",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Parent_ISBN",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Parent_Print_ISSN",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Parent_Online_ISSN",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                {
                    "valueType": "string",
                    "column": "Parent_URI",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false,
                    "caseSensitive": false
                },
                // Performance
                {
                    "valueType": "date",
                    "column": "Begin_Date",
                    "blankPosition": 2,
                    "errorPosition": 1,
                    "reverse": false
                }
            ]
        },
        "description": "Reorder records to match JSON organization"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "Count",
        "expression": "grel:'['+forEach(row.columnNames,field,if(isBlank(cells[field].value),'None',if(cells[field].value.type()=='date','\"'+cells[field].value.toString('yyyy-MM-dd')+'\"',if(cells[field].value.type()=='string','\"'+cells[field].value.replace('\"','\\\\\"')+'\"',cells[field].value.round())))).join(', ')+', \"2019-07-01\"],'",
        "onError": "set-to-blank",
        "newColumnName": "df",
        "columnInsertIndex": 0,
        "description": "Create column ``df`` with values and content for the fixture dataframes"
    }
]