[
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "columnName": "index",
        "expression": "value.toNumber()",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Make cells in column ``index`` numbers"
    },
    {
        "op": "core/transpose-columns-into-rows",
        "startColumnName": "7/1/2019",
        "columnCount": -1,
        "ignoreBlankCells": true,
        "fillDown": true,
        "separator": null,
        "keyColumnName": "Usage_Date",
        "valueColumnName": "Usage_Count",
        "description": "Pivot all columns with counts into two columns, one named ``Usage_Date`` with the column name/date and the other named ``Usage_Count`` with the data value/count"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "columnName": "Usage_Count",
        "expression": "value.toNumber()",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Make cells in column ``Usage_Count`` numbers"
    },
    {
        "op": "core/row-removal",
        "engineConfig": {
            "facets": [
                {
                    "type": "list",
                    "name": "Usage_Count",
                    "expression": "grel:or(isBlank(value),value==0)",
                    "columnName": "Usage_Count",
                    "invert": false,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": true,
                                "l": "true"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                }
            ],
            "mode": "row-based"
        },
        "description": "Remove rows with no usage"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "columnName": "Usage_Date",
        "expression": "value.toDate()",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Change the values in column ``Usage_Date`` to date data type"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_URI\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_URI",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_URI`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_Online_ISSN\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_Online_ISSN",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_Online_ISSN`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_Print_ISSN\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_Print_ISSN",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_Print_ISSN`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_ISBN\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_ISBN",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_ISBN`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_Proprietary_ID\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_Proprietary_ID",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_Proprietary_ID`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_DOI\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_DOI",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_DOI`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_Data_Type\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_Data_Type",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_Data_Type`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_Article_Version\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_Article_Version",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_Article_Version`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_Publication_Date\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_Publication_Date",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_Publication_Date`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_Authors\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_Authors",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_Authors`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Parent_Title\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Parent_Title",
        "columnInsertIndex": 1,
        "description": "Create column ``Parent_Title`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Metric_Type\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Metric_Type",
        "columnInsertIndex": 1,
        "description": "Create column ``Metric_Type`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Access_Method\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Access_Method",
        "columnInsertIndex": 1,
        "description": "Create column ``Access_Method`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Access_Type\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Access_Type",
        "columnInsertIndex": 1,
        "description": "Create column ``Access_Type`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"YOP\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "YOP",
        "columnInsertIndex": 1,
        "description": "Create column ``YOP`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "columnName": "YOP",
        "expression": "value.toNumber()",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Change values in column ``YOP`` to numbers"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Section_Type\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Section_Type",
        "columnInsertIndex": 1,
        "description": "Create column ``Section_Type`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Data_Type\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Data_Type",
        "columnInsertIndex": 1,
        "description": "Create column ``Data_Type`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Article_Version\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Article_Version",
        "columnInsertIndex": 1,
        "description": "Create column ``Article_Version`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Publication_Date\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Publication_Date",
        "columnInsertIndex": 1,
        "description": "Create column ``Publication_Date`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Authors\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Authors",
        "columnInsertIndex": 1,
        "description": "Create column ``Authors`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Online ISSN\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Online_ISSN",
        "columnInsertIndex": 1,
        "description": "Create column ``Online_ISSN`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Print ISSN\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Print_ISSN",
        "columnInsertIndex": 1,
        "description": "Create column ``Print_ISSN`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"ISBN\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "ISBN",
        "columnInsertIndex": 1,
        "description": "Create column ``ISBN`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Proprietary_ID\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Proprietary_ID",
        "columnInsertIndex": 1,
        "description": "Create column ``Proprietary_ID`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"DOI\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "DOI",
        "columnInsertIndex": 1,
        "description": "Create column ``DOI`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Platform\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Platform",
        "columnInsertIndex": 1,
        "description": "Create column ``Platform`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Publisher_ID\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Publisher_ID",
        "columnInsertIndex": 1,
        "description": "Create column ``Publisher_ID`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Publisher\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Publisher",
        "columnInsertIndex": 1,
        "description": "Create column ``Publisher`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Resource_Name\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Resource_Name",
        "columnInsertIndex": 1,
        "description": "Create column ``Resource_Name`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "index",
        "expression": "grel:cell.cross(\"nolcat_test_metadata\",\"index\").cells[\"Statistics_Source_ID\"].value[0]",
        "onError": "set-to-blank",
        "newColumnName": "Statistics_Source_ID",
        "columnInsertIndex": 1,
        "description": "Create column ``Statistics_Source_ID`` based on the column of the same name in the metadata project by matching the values in ``index``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "Statistics_Source_ID",
        "expression": "grel:\"[\"+forEach(row.columnNames,field,if(isBlank(cells[field].value),\"None\",if(cells[field].value.type()==\"date\",\"\\\"\"+cells[field].value.toString('yyyy-MM')+\"-01\\\"\",if(cells[field].value.type()==\"string\",\"\\\"\"+cells[field].value.replace(\"\\\"\",\"\\\\\\\"\")+\"\\\"\",cells[field].value)))).join(\", \")+\"],\"",
        "onError": "set-to-blank",
        "newColumnName": "df",
        "columnInsertIndex": 1,
        "description": "Create column ``df`` by combining all the other fields and formatting them for insertion into a dataframe"
    }
]